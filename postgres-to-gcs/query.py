from google.cloud import aiplatform_v1

# API_ENDPOINT="46767888.us-central1-711961201503.vdb.vertexai.goog"
# INDEX_ENDPOINT="projects/711961201503/locations/us-central1/indexEndpoints/5716004711040024576"
# DEPLOYED_INDEX_ID="pubmed_test_deployment_1713349358845"
API_ENDPOINT="14400247.us-central1-711961201503.vdb.vertexai.goog"
INDEX_ENDPOINT="projects/711961201503/locations/us-central1/indexEndpoints/8706394863614033920"
DEPLOYED_INDEX_ID="pubmed_ids_and_embeddings_deployed"

vector_search_client = aiplatform_v1.MatchServiceClient(
  client_options={ "api_endpoint": API_ENDPOINT },
)

datapoint = aiplatform_v1.IndexDatapoint(
  feature_vector=[-0.06331924,-0.016291903,-0.057023194,0.004499039,0.016935702,0.032378726,0.03945234,0.009010661,-0.0074753514,0.03922594,0.0014566876,0.035617962,0.0047199563,0.0014113152,0.017511863,-0.026233818,0.025769735,-0.0071158297,-0.0130942715,0.007871707,-0.005426422,-0.00783019,0.05498735,-0.017342832,0.025065506,0.0013199832,-0.0054008127,-0.07252492,-0.028190643,0.0011630458,-0.06558608,0.046787333,-0.077246524,-0.041920766,-0.007974402,-0.05256765,0.0139979245,0.006141255,-0.0016391681,0.036376417,-0.0034385396,-0.01301476,-0.025494201,-0.02450375,0.028392848,-0.029403409,0.014327833,0.07276782,-0.025977295,-0.061644208,0.005403021,-0.0019285721,0.026413882,-0.045024652,0.0035229153,-0.020754907,0.03274231,-0.0130667295,-0.004361778,-0.020418603,-0.023903275,-0.01742888,-0.04952638,-0.0011198024,-0.0017854297,-0.093114056,-0.025646556,0.006390225,0.13090204,-0.05993813,0.025103448,0.03130333,0.014444806,-0.033538274,-0.080092825,-0.13773113,-0.004187007,0.07541397,-0.02353651,0.060461957,0.0012665068,-0.019701924,-0.018181436,-0.021740394,-0.07404283,0.024192054,-0.0705741,-0.022478133,-0.015825756,-0.007925984,-0.024789501,-0.035971805,0.055065647,-0.043851644,-0.0025260707,0.02159272,-0.022750469,-0.029918557,0.026410606,-0.042868983,0.021110166,-0.003800405,-0.019499687,-0.04022127,0.033190157,0.026270445,0.017666146,0.041497495,-0.011586513,0.029094858,0.028436037,-0.0869386,-0.07649307,0.01287654,0.0215544,0.012502277,-0.025956055,0.052792337,0.057355504,0.020716695,0.04712162,0.016879618,0.031063471,-0.036209937,0.021835063,0.047772866,0.02709471,0.008694849,0.02012478,0.055290293,-0.05396505,-0.05529192,-0.0112459855,0.054492656,0.025230942,0.034775995,0.034930687,-0.013439088,0.056572508,0.013661166,-0.037837423,-0.0030079496,-0.016236749,-0.013185497,-0.05421925,-0.016341891,-0.036930535,-0.020635836,0.036744904,-0.01758031,-0.036339898,0.019193731,-0.088830374,0.00097207667,-0.021323254,0.008902727,-0.0006827109,0.03867725,-0.031630985,-0.022195734,0.04088721,-0.00716033,0.007791605,-0.0010429154,0.016848683,0.0030631165,-0.012386644,-0.004951729,-0.035400137,0.030188583,-0.024600169,-0.005039562,-0.045887724,-0.014796234,-0.0245319,-0.023553928,-0.026034404,0.032196008,-0.0655413,-0.035535827,-0.011726896,0.00722236,-0.032988697,-0.017012184,0.030902684,-0.019622376,0.07167934,0.020439304,-0.084114574,0.008190304,0.02003171,0.015311657,-0.047584604,0.019215215,-0.029468374,0.056731053,-0.046303675,-0.0038663012,0.014289233,-0.03711641,0.027962958,0.051605377,0.007807483,0.00015506019,0.079305224,-0.021825204,0.036311086,-0.011138865,-0.031325895,0.007879559,0.0057586855,0.03658916,-0.020561166,0.010928993,0.045744587,0.011152908,-0.017380124,-0.008803584,-0.0018574394,-0.011793883,-0.030938525,-0.020204209,0.026122728,0.031434234,0.027120471,0.06112624,0.021643711,0.037312914,0.018176831,-0.07637116,0.066175915,0.08124752,0.03259887,-0.05232017,-0.004275265,-0.019662742,-0.0050998186,-0.0025125195,-0.01024633,0.011296164,-0.0603628,0.07303448,0.012583383,0.015799794,-0.014665942,-0.021305528,0.020133577,-0.004512707,0.008972304,0.0477154,-0.03749868,-0.086112596,0.028125253,-0.007444994,-0.02059536,0.026883278,-0.024539543,-0.0018019545,-0.006976831,-0.08249278,0.045311756,-0.018179089,-0.0057147862,0.027361786,-0.009064651,-0.0055186814,-0.00260535,-0.066619255,-0.00403571,0.0487551,0.0034377978,-0.06893353,0.025108201,0.006050148,-0.009186884,0.028774126,0.0074886843,0.04965427,0.033219393,-0.029563667,-0.01698978,0.004347373,0.040274385,-0.045473516,-0.0092934305,-0.030101202,-0.052392777,0.0050903196,0.011487938,-0.03539618,-0.011824772,-0.014489067,0.0012668798,-0.022524966,0.015151618,-0.024652984,-0.061451346,0.021228168,0.017504534,-0.059927262,-0.03678985,0.02811243,-0.03504311,-0.0573481,0.031303536,0.012965991,-0.015971828,-0.015548561,-0.01607931,-0.040889334,-0.030886626,-0.017842542,-0.013591364,-0.002936346,-0.029257828,0.047402933,0.011215082,0.012388813,-0.036430523,0.020045362,-0.011660355,-0.012053665,0.0107927015,-0.03649088,0.021099638,-0.0045080436,-0.005564418,0.028756887,-0.016774643,-0.00309316,-0.010648358,-0.017877033,0.010020739,0.011680872,-0.009085672,-0.0032590488,-0.06748476,0.0075196717,0.0010682988,-0.0061263363,0.058401804,0.0022393533,-0.022533882,0.005999013,-0.024291348,0.015207536,-0.032989126,-0.018850759,0.07766261,0.010046125,-0.018956516,0.047569524,-0.027336214,0.0032671785,0.0074362354,-0.03255987,0.029111115,0.016955499,-0.002490362,-0.0709105,-0.03156929,-0.021464393,0.029985938,-0.0013555872,-0.00804759,-0.010323362,-0.023230128,0.022597304,-0.064270236,0.03044248,0.0719078,-0.060729593,0.038823847,-0.018845584,-0.012825016,-0.014511027,-0.03533756,0.004746416,0.03725644,-0.035003707,0.011401815,-0.022791805,0.047083355,0.010185815,0.0034411517,-0.051559627,0.034715805,0.03380593,-0.0013438967,0.07956191,0.033312373,0.017494261,0.061904375,0.030678462,-0.0048454558,-0.060782347,0.009107625,-0.0040699006,0.018407675,-0.0021372598,0.014818823,-0.08170006,-0.08980509,-0.0000078389585,-0.029433493,-0.0049839388,0.0073521594,0.013128304,0.023388088,0.012333697,0.005687783,0.0652008,-0.006113427,-0.056608547,-0.061299674,-0.030224748,0.014368217,-0.034010615,-0.018628543,0.03507908,-0.08090667,-0.01197309,0.037171032,0.0020193632,-0.054660264,-0.02359433,-0.013384916,0.0023761743,-0.040860966,0.04564964,0.015574422,0.028352046,0.017267916,0.008088626,-0.005893825,-0.03910943,0.039654814,0.02452662,-0.010619463,0.021984579,0.056121368,-0.005904156,0.059940502,-0.0086622555,-0.02636984,-0.019200685,0.033665866,-0.013114932,0.03669809,-0.09278054,0.014051604,-0.083792925,-0.037413828,-0.06255966,-0.031101266,-0.030639173,-0.009563097,0.014817796,0.03506527,0.0050416836,-0.011121579,-0.035515543,0.030655824,-0.07934086,0.05832872,-0.032391626,-0.0017590581,-0.027157648,-0.005056168,0.052429575,-0.028078705,-0.07813522,-0.008631824,-0.005921102,-0.06260493,0.001600031,-0.070643835,0.06468006,-0.069825515,-0.06811217,-0.008778815,-0.01712483,0.05807675,-0.0147844,-0.018037595,0.011792785,-0.031216398,-0.012037618,0.0061112144,-0.006267263,-0.014606505,-0.03505289,-0.009909354,-0.023632623,-0.0047729546,-0.008499081,-0.034723498,0.014242086,0.03719641,-0.03703755,0.020544907,-0.03434743,0.011449433,0.05288149,0.04534839,0.017002953,0.025922285,0.03551388,-0.020982698,0.019019669,-0.014016048,-0.031700976,0.061465833,-0.008067538,-0.0036744413,-0.0065433485,0.029667972,0.046579976,-0.057884946,-0.021987915,0.005857698,-0.014436496,-0.086595416,-0.005033426,0.064546615,-0.06259593,0.03941972,0.04528661,-0.017838042,0.006162809,-0.011030688,0.07956212,-0.05926634,0.026219683,0.01750752,0.0077386154,0.013720433,0.033337533,0.05523985,-0.0851851,0.019098647,-0.040437426,0.015163729,0.01980923,0.025385527,0.015458288,-0.045074686,-0.07509024,0.040581934,-0.009181139,0.010390598,-0.04763781,0.040456105,-0.0029980955,0.026266692,-0.021758147,-0.014161522,0.023067309,0.006077177,0.012459886,-0.024424111,-0.04785792,-0.0044263997,0.008400009,0.014673573,0.032492075,-0.057254814,-0.06543643,0.09028109,-0.069597006,0.04009376,0.038983464,0.0136085125,-0.0063301753,0.04622816,-0.06647057,-0.048295327,-0.013736748,-0.0193892,0.02339123,0.032218855,-0.028054586,-0.006996517,0.0711242,-0.01733578,0.03748773,0.0054919915,0.008287265,0.016030716,-0.06365843,-0.078318425,0.007089179,-0.04912312,-0.040782597,-0.029760342,0.056231298,0.029811196,-0.013776755,0.015540154,-0.02704033,0.0059366697,-0.03217731,0.008572541,0.00033502985,0.07267662,-0.02519392,-0.0004214212,-0.0087658595,-0.004213165,0.00007933353,-0.04845012,-0.046252515,-0.005051566,-0.028319068,-0.013479393,-0.025564315,0.07188612,-0.018809354,-0.021820582,-0.08746157,0.03682637,0.025431572,0.026864262,-0.041642375,0.02896033,-0.0034543902,-0.01976326,-0.033917345,0.035124294,0.032367345,0.015427942,-0.0009896699,0.017527882,0.03031803,-0.036889642,-0.01966688,0.024758145,-0.036944225,0.01770879,0.0116436705,-0.06061902,0.0017958384,0.022662137,0.007344909,0.00093423243,0.024202373,-0.026945477,-0.1255148,-0.032557674,-0.011048401,-0.02601206,-0.022725862,0.019111115,0.00015579241,-0.020496847,-0.009973651,-0.010368366,-0.041224834,0.025410764,-0.014230552,-0.017453376,-0.010860642,0.0012980978,0.028889593,-0.017074369,-0.0075876336,-0.063653514,-0.03827252,0.018684529,0.017827854,-0.03409012,0.013368796,0.039082136,-0.024079403,0.04141122,-0.01611063,-0.042388383,0.036405563,-0.018810628,0.031304616,-0.037469704,-0.061482318,-0.011849284,-0.0030112965,-0.00093704596,0.053896993,-0.002518767,0.014352976,-0.072624736,0.02583758,0.010113464,0.054862965,0.021952037,0.012838964,0.019714557,0.04098398,-0.016143166,-0.030272521,0.028775094,0.053546604,-0.016401654,-0.025437146,0.015896497,0.019013587,0.0070388247,0.049938016,0.009167024,-0.011305082,0.054336015,0.04541622,-0.024146102,-0.018006219,-0.024599528,0.117479384,-0.005724874,-0.030666344,-0.03511701,0.023924988,-0.046499293,0.011672152,0.07449082,0.02618371,0.0013522543,-0.032664523,-0.027208079,0.072981365,-0.03999746,0.008392548,-0.026933275,-0.017720118,0.0061691147,0.0024091527,-0.027702399,0.041186936,-0.03587489,0.050894264,-0.0066485326,-0.0072717527,-0.05781332,-0.037209306,0.0014616065,0.010838989,0.05879919,0.026240246,0.023874333,-0.07066504,-0.010712989,-0.024027672,0.047058716,-0.020408032,-0.010465619,0.018034704,-0.0105215125,0.021162778,0.056241553,-0.035287645,0.022396531,-0.049028214,0.010233868,0.0034536687,-0.03810688,0.022493074,0.019017352,0.030667808,0.06171178,-0.022402221,-0.090899155,0.03500785]
)
query = aiplatform_v1.FindNeighborsRequest.Query(
  datapoint=datapoint,
  neighbor_count=10
)
request = aiplatform_v1.FindNeighborsRequest(
  index_endpoint=INDEX_ENDPOINT,
  deployed_index_id=DEPLOYED_INDEX_ID,
  queries=[query],
  return_full_datapoint=False,
)

response = vector_search_client.find_neighbors(request)

print(response)
